(function(l){function U(o,f){var C,I,D,E,K,p,d,j,k,y,L,n,m,s,O,u,r,F,B,G,v,P,M,Q;function N(a,b){this.$container=a;var c=this.$container[0];b.bg&&(this.bg=document.createElement("div"),this.bg.className="htBorderBg "+b.className,c.insertBefore(this.bg,c.getElementsByTagName("table")[0]));this.main=document.createElement("div");this.main.style.position="absolute";this.main.style.top=0;this.main.style.left=0;this.main.innerHTML=Array(5).join('<div class="htBorder '+b.className+'"></div>');this.disappear();
c.appendChild(this.main);c=this.main.childNodes;this.top=c[0];this.left=c[1];this.bottom=c[2];this.right=c[3];this.borderWidth=l(this.left).width()}function T(a){this.$container=a;a=this.$container[0];this.handle=document.createElement("div");this.handle.className="htFillHandle";this.disappear();a.appendChild(this.handle);var b=this;l(this.handle).mousedown(function(){b.isDragged=1})}this.container=o;var i,e,g,R,t,H,w,z=this;p=K=E=!1;j=d=null;k=!1;L=y=null;m=n=0;O=s=null;Q=M=P=v=G=B=F=r=u=void 0;
var S="";i={data:[],createRow:function(a){for(var b=[],c=0;c<m;c++)b.push("");!a||a.row>=n?i.data.push(b):i.data.splice(a.row,0,b)},createCol:function(a){var b=0;if(!a||a.col>=m)for(;b<n;b++)i.data[b].push("");else for(;b<n;b++)i.data[b].splice(a.col,0,"")},removeRow:function(a,b){!a||a.row===n-1?i.data.pop():i.data.splice(a.row,b.row-a.row+1)},removeCol:function(a,b){var c=0;if(!a||a.col===m-1)for(;c<n;c++)i.data[c].pop();else for(var h=b.col-a.col+1;c<n;c++)i.data[c].splice(a.col,h)},get:function(a,
b){return i.data[a]?i.data[a][b]:void 0},set:function(a,b,c){i.data[a][b]=c},clear:function(){for(var a=0;a<n;a++)for(var b=0;b<m;b++)i.data[a][b]=""},getAll:function(){return i.data},getRange:function(a,b){var c,h,e,q,f=[],d;h=Math.max(a.row,b.row);q=Math.max(a.col,b.col);for(c=Math.min(a.row,b.row);c<=h;c++){d=[];for(e=Math.min(a.col,b.col);e<=q;e++)d.push(i.data[c][e]);f.push(d)}return f},getText:function(a,b){var c=i.getRange(a,b),h="",e,f,d,g;e=0;for(f=c.length;e<f;e++){d=0;for(g=c[e].length;d<
g;d++)0<d&&(h+="\t"),h+=c[e][d];h+="\n"}return h}};this.grid=e={alter:function(a,b,c){var h,A,f,d;h=l.extend(!0,[],i.getAll());switch(a){case "insert_row":i.createRow(b);e.createRow(b);break;case "insert_col":i.createCol(b);e.createCol(b);break;case "remove_row":i.removeRow(b,c);e.removeRow(b,c);e.keepEmptyRows();break;case "remove_col":i.removeCol(b,c),e.removeCol(b,c),e.keepEmptyRows()}b=[];a=i.getAll();c=0;for(A=a.length;c<A;c++){f=0;for(d=a[c].length;f<d;f++)b.push([c,f,h[c]?h[c][f]:null,a[c][f]])}z.container.triggerHandler("datachange.inputtable",
[b,"alter"])},createRow:function(a){var b,c;b=document.createElement("tr");for(c=0;c<m;c++)b.appendChild(document.createElement("td"));!a||a.row>=n?(u.appendChild(b),a=n):(c=e.getCellAtCoords(a).parentNode,u.insertBefore(b,c),a=a.row);n++;for(c=0;c<m;c++)e.updateLegend({row:a,col:c})},createCol:function(a){var b=u.childNodes,c;if(!a||a.col>=m){for(c=0;c<n;c++)b[c].appendChild(document.createElement("td"));a=m}else{for(c=0;c<n;c++)b[c].insertBefore(document.createElement("td"),e.getCellAtCoords({row:c,
col:a.col}));a=a.col}m++;for(c=0;c<n;c++)e.updateLegend({row:c,col:a})},removeRow:function(a,b){if(!a||a.row===n-1)l(u.childNodes[n-1]).remove(),n--;else for(var c=b.row;c>=a.row;c--)l(u.childNodes[c]).remove(),n--},removeCol:function(a,b){var c=u.childNodes,h=0;if(!a||a.col===m-1){for(;h<n;h++)l(c[h].childNodes[m-1]).remove();m--}else{for(;h<n;h++)for(var e=b.col;e>=a.col;e--)l(c[h].childNodes[e]).remove();m-=b.col-a.col+1}},keepEmptyRows:function(){var a,b,c,h,A=0,q=0,J,k=!1,o=!1,x=l(u);a=i.getAll();
J=a.length;b=J-1;a:for(;0<=b;b--){c=0;for(h=a[b].length;c<h;c++)if(""!==a[b][c])break a;A++}if(n<f.rows||A<f.minSpareRows)for(;n<f.rows||A<f.minSpareRows;A++)i.createRow(),e.createRow(),k=!0;if(f.minHeight&&0<x.height()&&x.height()<=f.minHeight)for(;x.height()<=f.minHeight;)i.createRow(),e.createRow(),k=!0;a=i.getAll();J=a.length;if(0<J){h=a[0].length;c=h-1;a:for(;0<=c;c--){for(b=0;b<J;b++)if(""!==a[b][c])break a;q++}}if(m<f.cols||q<f.minSpareCols)for(;m<f.cols||q<f.minSpareCols;q++)i.createCol(),
e.createCol(),o=!0;if(f.minWidth&&0<x.width()&&x.width()<=f.minWidth)for(;x.width()<=f.minWidth;)i.createCol(),e.createCol(),o=!0;if(!k)for(;f.rows&&n>f.rows&&f.minSpareRows&&A>f.minSpareRows&&(!f.minHeight||x.height()-x.find("tr:last").height()-4>f.minHeight);A--)e.removeRow(),i.removeRow(),k=!0;k&&d&&(d.row>n-1?(d.row=n-1,j.row>d.row&&(j.row=d.row)):j.row>n-1&&(j.row=n-1,d.row>j.row&&(d.row=j.row)));if(!o)for(;f.cols&&m>f.cols&&f.minSpareCols&&q>f.minSpareCols&&(!f.minWidth||x.width()-x.find("tr:last").find("td:last").width()-
4>f.minWidth);q--)i.removeCol(),e.removeCol(),o=!0;o&&d&&(d.col>m-1?(d.col=m-1,j.col>d.col&&(j.col=d.col)):j.col>m-1&&(j.col=m-1,d.col>j.col&&(d.col=j.col)));(k||o)&&g.refreshBorders();return k||o},updateLegend:function(a){if(f.legend||O){var b=l(e.getCellAtCoords(a));b.removeAttr("style").removeAttr("title").removeData("readOnly");b[0].className=""}if(f.legend)for(var c=0,h=f.legend.length;c<h;c++){var d=f.legend[c];d.match(a.row,a.col,z.getData)&&(O=!0,"undefined"!==typeof d.style&&b.css(d.style),
"undefined"!==typeof d.readOnly&&b.data("readOnly",d.readOnly),"undefined"!==typeof d.title&&b.attr("title",d.title),"undefined"!==typeof d.className&&b.addClass(d.className))}},isCellWriteable:function(a){return L&&a.data("readOnly")?!1:!0},populateFromArray:function(a,b,c){var h,d,q,k,n,o,j=[],m={};d=b.length;if(0===d)return!1;m.row=a.row;m.col=a.col;for(h=0;h<d&&!(c&&m.row>c.row);h++){m.col=a.col;k=b[h]?b[h].length:0;for(q=0;q<k&&!(c&&m.col>c.col);q++)n=e.getCellAtCoords(m),e.isCellWriteable(l(n))&&
j.push([m.row,m.col,i.get(m.row,m.col),b[h][q]]),m.col++,c&&q===k-1&&(q=-1);m.row++;c&&h===d-1&&(h=-1)}if(f.onBeforeChange&&j.length&&!1===f.onBeforeChange(j))return e.getCellAtCoords(a);b=0;for(h=j.length;b<h;b++)if(!c||!(j[b][0]>c.row||j[b][1]>c.col))!1!==j[b][3]&&(o=z.setDataAtCell(j[b][0],j[b][1],j[b][3]));j.length&&z.container.triggerHandler("datachange.inputtable",[j,"populateFromArray"]);setTimeout(function(){e.keepEmptyRows()||g.refreshBorders()},100);return o||e.getCellAtCoords(a)},clear:function(){for(var a=
e.getAllCells(),b=0,c=a.length;b<c;b++)l(a[b]).empty(),e.updateLegend(e.getCellCoords(a[b]))},getCellCoords:function(a){return{row:a.parentNode.rowIndex,col:a.cellIndex}},getCellAtCoords:function(a){if(0>a.row||0>a.col)return null;var b=u.childNodes[a.row];return b?b.childNodes[a.col]:null},getCornerCoords:function(a){function b(a,b,e){function d(a){return a[e]}return Array.prototype.map?a.apply(Math,b.map(d)):a.apply(Math,l.map(b,d))}return{TL:{row:b(Math.min,a,"row"),col:b(Math.min,a,"col")},BR:{row:b(Math.max,
a,"row"),col:b(Math.max,a,"col")}}},getCellsAtCoords:function(a,b){var c=e.getCornerCoords([a,b]),h,d,f=[];for(h=c.TL.row;h<=c.BR.row;h++)for(d=c.TL.col;d<=c.BR.col;d++)f.push(e.getCellAtCoords({row:h,col:d}));return f},getAllCells:function(){var a=[],b,c,h,e,d;b=u.childNodes;h=n;if(0<h){d=m;for(c=0;c<h;c++)for(e=0;e<d;e++)a.push(b[c].childNodes[e])}return a}};g={setRangeStart:function(a){g.deselect();d=e.getCellCoords(a);g.setRangeEnd(a)},setRangeEnd:function(a){var b=e.getCellCoords(a);g.end(b);
f.multiSelect||(d=b);g.refreshBorders();H.scrollViewport(a)},refreshBorders:function(){g.isSelected()&&(r&&w.showHandle(),F.appear([d]),H.on(),t.prepare())},start:function(a){a&&(d=a);return d},end:function(a){a&&(j=a);return j},isMultiple:function(){return!(j.col===d.col&&j.row===d.row)},transformStart:function(a,b){var c=e.getCellAtCoords({row:d.row+a,col:d.col+b});c?g.setRangeStart(c):g.setRangeStart(e.getCellAtCoords(d))},transformEnd:function(a,b){var c=e.getCellAtCoords({row:j.row+a,col:j.col+
b});c&&g.setRangeEnd(c)},isSelected:function(){var a=g.end();return!a||"undefined"===typeof a.row?!1:!0},inInSelection:function(a){if(!g.isSelected())return!1;var b=e.getCornerCoords([d,j]);return b.TL.row<=a.row&&b.BR.row>=a.row&&b.TL.col<=a.col&&b.BR.col>=a.col},deselect:function(){g.isSelected()&&(p&&t.finishEditing(),H.off(),F.disappear(),r&&w.hideHandle(),g.end(!1))},selectAll:function(){if(f.multiSelect){var a=e.getAllCells();a.length&&(g.setRangeStart(a[0]),g.setRangeEnd(a[a.length-1]))}},
empty:function(){if(g.isSelected()){var a,b,c,h=[],f,q,k;a=e.getCellsAtCoords(d,g.end());b=0;for(c=a.length;b<c;b++)f=e.getCellCoords(a[b]),q=i.get(f.row,f.col),k=l(a[b]),""!==q&&e.isCellWriteable(k)&&(k.empty(),i.set(f.row,f.col,""),h.push([f.row,f.col,q,""]),e.updateLegend(f));h.length&&z.container.triggerHandler("datachange.inputtable",[h,"empty"]);e.keepEmptyRows();g.refreshBorders()}}};H={init:function(){B=new N(o,{className:"selection",bg:!0})},on:function(){if(!g.isSelected())return!1;g.isMultiple()?
B.appear([d,g.end()]):B.disappear()},off:function(){if(!g.isSelected())return!1;B.disappear()},scrollViewport:function(a){if(!g.isSelected())return!1;var a=l(a),b=a.offset(),c=s.scrollLeft(),e=s.scrollTop(),d=s.outerWidth()-24,f=s.outerHeight()-24,k=s.offset(),i=b.top,j=b.left;k&&(i+=e-k.top,j+=c-k.left);var m=a.outerHeight(),n=a.outerWidth();c+d<=j+n?setTimeout(function(){s.scrollLeft(j+n-d)},1):c>j&&setTimeout(function(){s.scrollLeft(j-2)},1);e+f<=i+m?setTimeout(function(){s.scrollTop(i+m-f)},1):
e>i&&setTimeout(function(){s.scrollTop(i-2)},1)}};w={init:function(){r=new T(o);G=new N(o,{className:"htFillBorder"});l(r.handle).on("dblclick",w.selectAdjacent)},selectAdjacent:function(){var a,b,c,h,d;a=g.isMultiple()?B.corners:F.corners;G.disappear();if(0<a.TL.col){b=i.getAll();c=a.BR.row+1;a:for(;c<n;c++){for(d=a.TL.col;d<=a.BR.col;d++)if(b[c][d])break a;b[c][a.TL.col-1]&&(h=c)}h&&(w.showBorder(e.getCellAtCoords({row:h,col:a.BR.col})),w.apply())}},apply:function(){var a,b,c,d;r.isDragged=0;if(a=
G.corners)(G.disappear(),b=g.isMultiple()?B.corners:F.corners,a.TL.row===b.TL.row&&a.TL.col<b.TL.col?(c=a.TL,d={row:a.BR.row,col:b.TL.col-1}):a.TL.row===b.TL.row&&a.BR.col>b.BR.col?(c={row:a.TL.row,col:b.BR.col+1},d=a.BR):a.TL.row<b.TL.row&&a.TL.col===b.TL.col?(c=a.TL,d={row:b.TL.row-1,col:a.BR.col}):a.BR.row>b.BR.row&&a.TL.col===b.TL.col&&(c={row:b.BR.row+1,col:a.TL.col},d=a.BR),c)?(b=R.parsePasteInput(k.val()),e.populateFromArray(c,b,d),g.setRangeStart(e.getCellAtCoords(a.TL)),g.setRangeEnd(e.getCellAtCoords(a.BR))):
g.refreshBorders()},showHandle:function(){r.appear([d,j])},hideHandle:function(){r.disappear()},showBorder:function(a){var a=e.getCellCoords(a),b=e.getCornerCoords([d,j]);if("horizontal"!==f.fillHandle&&(b.BR.row<a.row||b.TL.row>a.row))a={row:a.row,col:b.BR.col};else if("vertical"!==f.fillHandle)a={row:b.BR.row,col:a.col};else return;G.appear([d,j,a])}};R={parsePasteInput:function(a){var b,c,a=a.split("\n");""===a[a.length-1]&&a.pop();b=0;for(c=a.length;b<c;b++)a[b]=a[b].split("\t");return a}};t=
{init:function(){k=l('<textarea class="inputtableInput">');v=l('<div class="inputtableInputHolder">');v.append(k);k.on("click",function(a){a.stopPropagation()});k.on("cut",function(){t.finishEditing();setTimeout(function(){g.empty()},100)});k.on("paste",function(){t.finishEditing();setTimeout(function(){var a=k.val().replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),a=R.parsePasteInput(a),b=e.getCornerCoords([d,j]),a=e.populateFromArray(b.TL,a,{row:Math.max(b.BR.row,a.length-1+b.TL.row),col:Math.max(b.BR.col,
a[0].length-1+b.TL.col)});g.setRangeEnd(a)},100)});k.on("keydown",function(a){P=a.keyCode;if(g.isSelected()){var b=(a.ctrlKey||a.metaKey)&&!a.altKey;if(32==a.keyCode||48<=a.keyCode&&57>=a.keyCode||96<=a.keyCode&&111>=a.keyCode||186<=a.keyCode&&192>=a.keyCode||219<=a.keyCode&&222>=a.keyCode||65<=a.keyCode&&90>=a.keyCode)b?b&&65===a.keyCode&&g.selectAll():t.beginEditing();else switch(b=a.shiftKey?g.setRangeEnd:g.setRangeStart,a.keyCode){case 38:if(isAutoComplete())return!0;a.shiftKey?g.transformEnd(-1,
0):t.finishEditing(!1,-1,0);a.preventDefault();break;case 39:case 9:if(!p||9===a.keyCode)a.shiftKey?g.transformEnd(0,1):isAutoComplete()||t.finishEditing(!1,0,1),a.preventDefault();break;case 37:p||(a.shiftKey?g.transformEnd(0,-1):t.finishEditing(!1,0,-1),a.preventDefault());break;case 8:case 46:p||(g.empty(a),a.preventDefault());break;case 27:case 113:case 13:case 40:if(p){if(a.shiftKey||isAutoComplete()&&40===a.keyCode)return!0;if(27===a.keyCode||13===a.keyCode||40===a.keyCode)27===a.keyCode?t.finishEditing(!0,
0,0):isAutoComplete()||t.finishEditing(!1,1,0),a.preventDefault()}else 113===a.keyCode||13===a.keyCode?(t.beginEditing(!0),13===a.keyCode&&a.shiftKey||a.preventDefault()):40===a.keyCode&&(a.shiftKey?g.transformEnd(1,0):g.transformStart(1,0));break;case 36:p||(a.ctrlKey||a.metaKey?b(e.getCellAtCoords({row:0,col:d.col})):b(e.getCellAtCoords({row:d.row,col:0})));break;case 35:p||(a.ctrlKey||a.metaKey?b(e.getCellAtCoords({row:n-1,col:d.col})):b(e.getCellAtCoords({row:d.row,col:m-1})));break;case 33:b(e.getCellAtCoords({row:0,
col:d.col}));break;case 34:b(e.getCellAtCoords({row:n-1,col:d.col}))}}});k.on("keyup",function(a){M&&(a.stopImmediatePropagation(),M=!1)});k.on("change",function(){if(isAutoComplete()){var a=k.val();a!==S&&a===Q&&(p=!0,9===P?t.finishEditing(!1,0,1):t.finishEditing(!1,1,0));S=a}});o.append(v)},prepare:function(){k.height(k.parent().innerHeight()-4);k.val(i.getText(d,j));setTimeout(t.focus,1);if(f.autoComplete){var a=k.data("typeahead");a||(k.typeahead({updater:function(a){return Q=a}}),a=k.data("typeahead"));
a.source=[];for(var b=0,c=f.autoComplete.length;b<c;b++)if(f.autoComplete[b].match(d.row,d.col,z.getData)){a.source=f.autoComplete[b].source();a.highlighter=f.autoComplete[b].highlighter||defaultAutoCompleteHighlighter;break}}a=e.getCellAtCoords(d);b=l(a).offset();c=o.offset();a=b.top-c.top+o.scrollTop()-1;b=b.left-c.left+o.scrollLeft()-1;l.browser.mozilla||(l.browser.msie&&(8>parseInt(l.browser.version)?a-=2:8===parseInt(l.browser.version)&&(a-=1)),a+=1,b+=1);v.addClass("htHidden");v.css({top:a,
left:b,overflow:"hidden",zIndex:1});k.css({width:"1000px",height:"1000px"})},focus:function(){k[0].select()},beginEditing:function(a){if(!p){r&&w.hideHandle();var b=e.getCellAtCoords(d),b=l(b);p=!0;S="";g.isMultiple()&&(H.off(),j=d,H.on());e.isCellWriteable(b)&&(a?k.val(i.get(d.row,d.col)):k.val(""),k.autoResize?k.autoResize({maxHeight:200,minHeight:b.outerHeight()-4,minWidth:b.width(),maxWidth:Math.max(168,b.width()),animate:!1,extraSpace:0}):k.css({width:1.5*b.width(),height:b.height()}),v.removeClass("htHidden"),
v.css({overflow:"visible",zIndex:4}),f.autoComplete&&(k.data("typeahead").lookup(),M=!0))}},finishEditing:function(a,b,c){if(p){p=!1;var h=e.getCellAtCoords(d),h=l(h),j=l.trim(k.val()),m=i.get(d.row,d.col);if(m!==j&&e.isCellWriteable(h)){var n,h=[[d.row,d.col,m,j]];f.onBeforeChange&&(n=f.onBeforeChange(h));!1!==n&&!1!==h[0][3]?(z.setDataAtCell(h[0][0],h[0][1],h[0][3]),z.container.triggerHandler("datachange.inputtable",[h,"type"]),e.keepEmptyRows()):a=!0}k.css({width:"1000px",height:"1000px"});v.addClass("htHidden");
v.css({overflow:"hidden"})}"undefined"!==typeof b&&"undefined"!==typeof c&&(a?g.refreshBorders():g.transformStart(b,c))}};C=function(a){K=!0;2===a.button&&g.inInSelection(e.getCellCoords(this))||(a.shiftKey?g.setRangeEnd(this):g.setRangeStart(this))};I=function(){K?g.setRangeEnd(this):r&&r.isDragged&&(r.isDragged++,w.showBorder(this))};D=function(){k[0].focus();t.beginEditing(!0)};this.init=function(){function a(){E=!0}function b(){E=!1}y=l('<table cellspacing="0" cellpadding="0"><tbody></tbody></table>');
u=y.find("tbody")[0];y.on("mousedown","td",C);y.on("mouseover","td",I);y.on("dblclick","td",D);o.append(y);m=f.cols;e.keepEmptyRows();H.init();F=new N(o,{className:"current",bg:!0});f.fillHandle&&w.init();t.init();y.on("mouseenter",a);y.on("mouseleave",b);k.on("mouseenter",a);k.on("mouseleave",b);r&&(l(r.handle).on("mouseenter",a).on("mouseleave",b),l(G.main).on("mouseenter",a).on("mouseleave",b));l(B.main).on("mouseenter",a).on("mouseleave",b);l(F.main).on("mouseenter",a).on("mouseleave",b).on("dblclick",
D);l("html").on("mouseup",function(){K=false;if(r&&r.isDragged){r.isDragged>1&&w.apply();r.isDragged=0}});l("html").on("click",function(){setTimeout(function(){E||g.deselect()},1)});"html"!==o[0].tagName.toLowerCase()&&"body"!==o[0].tagName.toLowerCase()&&"scroll"===o.css("overflow")?s=o:o.parents().each(function(){if(this.tagName.toLowerCase()!=="html"&&this.tagName.toLowerCase()!=="body"&&l(this).css("overflow")=="scroll"){s=l(this);return false}});s?(s.scrollTop(0),s.scrollLeft(0)):s=l(window);
s.on("scroll",function(a){a.stopPropagation()});if(f.contextMenu){var c=function(a){var b=e.getCornerCoords([d,j]);return((a==="row_above"||a==="remove_row")&&b.TL.row===0||(a==="col_left"||a==="remove_col")&&b.TL.col===0)&&l(e.getCellAtCoords(b.TL)).data("readOnly")?true:false},c={undo:{name:"Undo",disabled:function(){return true}},redo:{name:"Redo",disabled:function(){return true}},sep1:"---------",row_above:{name:"Insert row above",disabled:c},row_below:{name:"Insert row below"},sep2:"---------",
col_left:{name:"Insert column on the left",disabled:c},col_right:{name:"Insert column on the right"},sep3:"---------",remove_row:{name:"Remove row",disabled:c},remove_col:{name:"Remove column",disabled:c}};!0===f.contextMenu&&(f.contextMenu="row_above row_below sep2 col_left col_right sep3 remove_row remove_col".split(" "));for(var h={},i=0,n=f.contextMenu.length;i<n;i++)h[f.contextMenu[i]]=c[f.contextMenu[i]];l.contextMenu({selector:o.attr("id")?"#"+o.attr("id"):"."+o[0].className.replace(/[\s]+/g,
" ."),trigger:"right",callback:function(a){var b=e.getCornerCoords([d,j]);switch(a){case "row_above":e.alter("insert_row",b.TL);break;case "row_below":e.alter("insert_row",{row:b.BR.row+1,col:0});break;case "col_left":e.alter("insert_col",b.TL);break;case "col_right":e.alter("insert_col",{row:0,col:b.BR.col+1});break;case "remove_row":case "remove_col":e.alter(a,b.TL,b.BR);break;case "undo":(void 0).undo();break;case "redo":(void 0).redo()}},items:h})}z.container.on("datachange.inputtable",function(a,
b){if(f.onChange)f.onChange(b)})};this.setDataAtCell=function(a,b,c){if(f.minSpareRows)for(;a>n-1;)i.createRow(),e.createRow();if(f.minSpareCols)for(;b>m-1;)i.createCol(),e.createCol();var d=e.getCellAtCoords({row:a,col:b});switch(typeof c){case "string":break;case "number":c+="";break;default:c=""}d.innerHTML=c.replace(/\n/g,"<br/>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");i.set(a,b,c);e.updateLegend({row:a,col:b});return d};this.loadData=
function(a){L=!1;i.clear();e.clear();e.populateFromArray({row:0,col:0},a);L=!0};this.getData=function(){return i.getAll()};this.updateSettings=function(a){for(var b in a)a.hasOwnProperty(b)&&(f[b]=a[b]);e.keepEmptyRows()||g.refreshBorders()};this.clear=function(){g.selectAll();g.empty()};this.alter=function(a,b,c){"undefined"===typeof c&&(c=b);switch(a){case "insert_row":case "remove_row":e.alter(a,{row:b,col:0},{row:c,col:0});break;case "insert_col":case "remove_col":e.alter(a,{row:0,col:b},{row:0,
col:c})}};this.getCell=function(a,b){return e.getCellAtCoords({row:a,col:b})};N.prototype={appear:function(a){var b,c,d,f,g;this.corners=e.getCornerCoords(a);b=l(e.getCellAtCoords(this.corners.TL));c=1<a.length?l(e.getCellAtCoords(this.corners.BR)):b;d=b.offset();f=1<a.length?c.offset():d;b=this.$container.offset();g=d.top;a=f.top+c.outerHeight()-g;d=d.left;c=f.left+c.outerWidth()-d;g=g-b.top+this.$container.scrollTop()-1;b=d-b.left+this.$container.scrollLeft()-1;l.browser.mozilla||(l.browser.msie&&
9>parseInt(l.browser.version)&&(g-=1),g+=1,b+=1);0>g&&(g=0);0>b&&(b=0);this.bg&&(this.bg.style.top=g+"px",this.bg.style.left=b+"px",this.bg.style.width=c+"px",this.bg.style.height=a+"px",this.bg.style.display="block");this.top.style.top=g+"px";this.top.style.left=b+"px";this.top.style.width=c+"px";this.left.style.top=g+"px";this.left.style.left=b+"px";this.left.style.height=a+"px";d=Math.floor(this.borderWidth/2);this.bottom.style.top=g+a-d+"px";this.bottom.style.left=b+"px";this.bottom.style.width=
c+"px";this.right.style.top=g+"px";this.right.style.left=b+c-d+"px";this.right.style.height=a+1+"px";this.main.style.display="block"},disappear:function(){this.main.style.display="none";this.bg&&(this.bg.style.display="none");this.corners=null}};T.prototype={appear:function(a){var b,c,d,a=e.getCornerCoords(a);b=l(e.getCellAtCoords(a.BR));c=b.offset();d=this.$container.offset();a=c.top-d.top+this.$container.scrollTop()-1;c=c.left-d.left+this.$container.scrollLeft()-1;d=b.outerHeight();b=b.outerWidth();
this.handle.style.top=a+d-3+"px";this.handle.style.left=c+b-3+"px";this.handle.style.display="block"},disappear:function(){this.handle.style.display="none"}}}l.fn.inputtable=function(o,f){var C,I,D,E=[];if("string"!==typeof o)return f=o,this.each(function(){var o=l(this);if(o.data("inputtable"))p=o.data("inputtable"),p.updateSettings(f);else{var p=l.extend({},V),p;f&&l.extend(p,f);p=new U(o,p);o.data("inputtable",p);p.init()}});D=[];if(1<arguments.length){C=1;for(I=arguments.length;C<I;C++)D.push(arguments[C])}this.each(function(){E=
l(this).data("inputtable")[o].apply(this,D)});return E};var V={rows:5,cols:5,minSpareRows:0,minSpareCols:0,minHeight:0,minWidth:0,multiSelect:!0,fillHandle:!0,undo:!0}})(jQuery);var inputtable={};